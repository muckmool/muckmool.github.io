<html>

<script>

   arr = [".", ".",".","."];
       
    fetch('https://muckmool.github.io/book/nanjungilgi.json')
      .then((response) => response.json())
      .then((data) => { 
        
        let temp = data.book; 
        let max = temp.length;
        //console.log(max); 

        for (i = 0; i < max; i += 1) {
            arr.push(data.book[i].date);
            arr.push(data.book[i].hanja);
            arr.push(data.book[i].hangul);
            arr.push(data.book[i].story);


        }  
    
      } 
    );

</script>



<script>

    function search()  {
        const resultElement1 = document.getElementById('result1');
        const resultElement2 = document.getElementById('result2');
        const resultElement3 = document.getElementById('seq');
        const resultElement4 = document.getElementById('result4');
        const resultElement5 = document.getElementById('result5');

        let i = resultElement3.value;
        i = parseInt(i);

        //console.log(i);

        let hanja_temp1 = arr[i*4 + 1];
        let hanja_temp2 = hanja_temp1.split('');
        const max = hanja_temp2.length;

        //console.log(max);

        let hangul_temp1 = arr[i*4 + 2];
        let hangul_temp2 = hangul_temp1.split('');

        let hanja_temp3 ="";

        for (j = 0; j < max; j += 1) {
             hanja_temp3 = hanja_temp3 + "<ruby>" + hanja_temp2[j] + "<rt>" + hangul_temp2[j] + "</rt>" + "</ruby>";
        }

        //console.log(hanja_temp3);

        resultElement1.innerText = arr[i*4];
        resultElement2.innerHTML = hanja_temp3;
        resultElement4.innerText = arr[i*4 + 3];
        resultElement5.innerText = arr[i*4 + 2];

    }


    function next()  {
        const resultElement1 = document.getElementById('result1');
        const resultElement2 = document.getElementById('result2');
        const resultElement3 = document.getElementById('seq');
        const resultElement4 = document.getElementById('result4');
        const resultElement5 = document.getElementById('result5');

        let i = resultElement3.value;
        i = parseInt(i);

        i = i + 1;

        if((i*4 + 3) > arr.length) { i = i - 1; }

        //console.log(i);

        let hanja_temp1 = arr[i*4 + 1];
        let hanja_temp2 = hanja_temp1.split('');
        const max = hanja_temp2.length;

        //console.log(max);

        let hangul_temp1 = arr[i*4 + 2];
        let hangul_temp2 = hangul_temp1.split('');

        let hanja_temp3 ="";

        for (j = 0; j < max; j += 1) {
             hanja_temp3 = hanja_temp3 + "<ruby>" + hanja_temp2[j] + "<rt>" + hangul_temp2[j] + "</rt>" + "</ruby>";
        }

        console.log(hanja_temp3);

        resultElement1.innerText = arr[i*4];
        resultElement2.innerHTML = hanja_temp3;
        resultElement4.innerText = arr[i*4 + 3];
        resultElement5.innerText = arr[i*4 + 2];
    }


    function previous()  {
        const resultElement1 = document.getElementById('result1');
        const resultElement2 = document.getElementById('result2');
        const resultElement3 = document.getElementById('seq');
        const resultElement4 = document.getElementById('result4');
        const resultElement5 = document.getElementById('result5');

        let i = resultElement3.value;
        i = parseInt(i);

        i = i - 1;

        if(i < 1) { i = 1; }

        //console.log(i);

        let hanja_temp1 = arr[i*4 + 1];
        let hanja_temp2 = hanja_temp1.split('');
        const max = hanja_temp2.length;

        //console.log(max);

        let hangul_temp1 = arr[i*4 + 2];
        let hangul_temp2 = hangul_temp1.split('');

        let hanja_temp3 ="";

        for (j = 0; j < max; j += 1) {
             hanja_temp3 = hanja_temp3 + "<ruby>" + hanja_temp2[j] + "<rt>" + hangul_temp2[j] + "</rt>" + "</ruby>";
        }

        console.log(hanja_temp3);

        resultElement1.innerText = arr[i*4];
        resultElement2.innerHTML = hanja_temp3;
        resultElement4.innerText = arr[i*4 + 3];
        resultElement5.innerText = arr[i*4 + 2];
    }

    // TTS

    function speak() {
       
       window.speechSynthesis.cancel(); // 현재 읽고있다면 초기화
   
       const speechMsg = new SpeechSynthesisUtterance();
       speechMsg.rate =  1; // 속도: 0.1 ~ 10      
       speechMsg.pitch = 1; // 음높이: 0 ~ 2
       speechMsg.lang =  "ko-KR";
       speechMsg.text = document.getElementById("result1").textContent + document.getElementById("result5").textContent + document.getElementById("result4").textContent;
       
       // SpeechSynthesisUtterance에 저장된 내용을 바탕으로 음성합성 실행
       window.speechSynthesis.speak(speechMsg)
   }
   
 


</script>


<p>SEQ <input type = "text" style="width:200px;height:40px;font-size:15px;" id="seq" value = 1>

    <input type='button' onclick='search()' value='search'/>
    <input type='button' onclick='speak()' value='TTS'/>
    <input type='button' onclick='previous()' value='previous'/>
    <input type='button' onclick='next()' value='next'/>

<br><br>

<!--
<p id="result1">.</p>
<p id="result2" style="font-size:23px; font-weight: 500;">.</p>
<p id="result5">.</p>
<p id="result4">.</p>
-->

<table style="border-collapse: collapse; width: 100%;" border="0" width="100%" text-align="center">


    <tbody>   
        <tr><td id="result1">.</td></tr>
        <tr><td>&nbsp</td></tr>
        <tr><td id="result2" style="font-size:23px; font-weight: 500;">.</td></tr>
        <tr><td>&nbsp</td></tr>
        <tr><td id="result5">.</td></tr>
        <tr><td>&nbsp</td></tr>
        <tr><td id="result4">.</td></tr>
    </tbody>
</table>

</html>